# aiTools - Chrome 扩展程序项目说明

## 项目背景

这是一个名为 **aiTools** 的 Chrome 浏览器扩展项目，专门为几个 AI 相关网站提供个性化增强功能。项目使用 Manifest V3 规范，旨在为特定的 AI 网站提供自动化操作和用户体验优化，支持多个 AI 平台的特殊处理。

## 针对不同网站的特别处理

### 1. **Grok 网站** (`x.com/i/grok` 和 `grok.com`)

#### 界面自动优化 (`grok_content.js`)

- **专注模式自动激活**：自动点击"专注模式"按钮，获得更清洁的对话视图
- **输入框优化**：自动调整输入框高度至 86px，提供更舒适的输入体验
- **自动聚焦**：页面加载后自动将光标聚焦到输入框，可立即开始输入

#### 快捷键文本插入 (`grok_insert_text.js`)

- **快捷键支持**：`Ctrl+Q` (Windows/Linux) 或 `Command+Shift+G` (Mac)
- **预设文本**：自动插入中文提示文本："你是一名计算机专家，编程高手。我是一名普通程序员。请用中文来解释。"
- **智能检测**：自动检测页面中的输入框（textarea 或 text input）

### 2. **Pinterest 图片** (`i.pinimg.com`)

#### 自动获取原图 (`pinterest_content.js`)

- **URL 自动转换**：将图片 URL 中的尺寸标识（`736x`、`1200x`）自动替换为`originals`
- **无缝跳转**：自动跳转到原始尺寸图片页面
- **智能下载**：检测到原始图片后自动触发浏览器下载
- **多重检测**：结合页面加载事件和 DOM 监控，确保下载成功触发

### 3. **Google AI Studio** (`aistudio.google.com/prompts/`)

#### 自动保存功能 (`gemini_auto_save.js`)

- **定时保存**：每 30 秒自动尝试点击"保存 Prompt"按钮
- **智能检测**：检查按钮状态（是否存在、是否可用、是否可见）
- **防丢失保护**：防止长时间编辑时意外丢失未保存的内容
- **状态日志**：详细的操作日志，便于调试和监控

### 4. **Medium** (`medium.com`)

#### 隐藏文本选择菜单 (`medium_content.js`)

- **菜单隐藏**：自动隐藏选中文本时弹出的操作菜单（强调、回应、分享、私人笔记等按钮）
- **清洁阅读**：提供更清洁的阅读体验，避免选择文本时的界面干扰
- **多重保障**：使用 CSS 样式和动态监控相结合，确保菜单始终保持隐藏状态
- **兼容性强**：支持多种选择器，适应网站结构变化

### 5. **通用滚动控制** (所有网站)

#### 智能滚动系统 (`scroll_control.js` + `popup.js`)

- **多速度选择**：提供正常、5 倍速、10 倍速三种自动滚动选项
- **自动刷新机制**：滚动 3 分钟后自动执行：停止滚动 → 回到顶部 → 刷新页面
- **状态持久化**：滚动状态保存在会话中，刷新后 5 分钟内自动恢复
- **智能底部检测**：到达页面底部后自动平滑滚动回顶部继续
- **兼容性检查**：自动检测页面类型，对特殊页面（chrome://、扩展页面等）禁用功能
- **用户友好界面**：显示当前域名，提供直观的控制按钮

## 技术架构

### 核心文件结构

```
aiTools/
├── manifest.json          # 扩展配置入口，定义权限和内容脚本
├── background.js          # 后台服务，处理快捷键和跨脚本通信
├── popup.html/js          # 扩展弹窗界面，控制滚动功能
├── grok_content.js        # Grok网站界面优化
├── grok_insert_text.js    # Grok快捷键文本插入
├── pinterest_content.js   # Pinterest图片处理
├── gemini_auto_save.js    # Google AI Studio自动保存
├── medium_content.js      # Medium菜单隐藏
├── scroll_control.js      # 通用滚动控制
└── images/               # 扩展图标资源
```

### 技术特点

- **Manifest V3 规范**：使用最新的 Chrome 扩展 API
- **内容脚本注入**：针对特定网站注入相应功能脚本
- **消息传递机制**：background.js 与内容脚本间的通信
- **会话存储**：使用 sessionStorage 保持状态持久化
- **DOM 监控**：MutationObserver 监控页面动态变化
- **平滑动画**：使用 requestAnimationFrame 实现流畅滚动效果
- **错误处理**：完善的错误捕获和日志记录机制

### 权限管理

- `storage`：存储用户设置和状态
- `activeTab`：访问当前活动标签页
- `scripting`：注入内容脚本
- `downloads`：触发图片下载
- `tabs`：标签页操作
- `clipboardWrite`：剪贴板写入（预留）

## 项目优势

### 1. **针对性强**

- 专门为 AI 工具网站设计，解决实际使用痛点
- 每个功能都针对特定场景优化

### 2. **用户体验优秀**

- 自动化繁琐操作，提升使用效率
- 无侵入式设计，不影响原有功能
- 智能状态管理，用户无需重复设置

### 3. **技术实现成熟**

- 使用现代 Chrome 扩展 API
- 完善的错误处理和日志系统
- 良好的代码组织和模块化设计

### 4. **扩展性良好**

- 模块化架构，易于添加新网站支持
- 统一的消息传递机制
- 清晰的文件组织结构

## 使用场景

### 开发者场景

- 在 Grok 上快速获得中文编程解答
- 在 Google AI Studio 中安全编辑长 Prompt
- 高效浏览技术文章和文档

### 内容创作者场景

- 快速收集 Pinterest 高质量原图
- 清洁的 Medium 阅读体验
- 自动化的内容浏览和收集

### 研究学习场景

- 自动滚动浏览大量内容
- 专注的 AI 对话体验
- 高效的资料收集和整理

## 项目特色

### 智能化

- 自动检测页面状态和元素
- 智能的错误恢复机制
- 自适应的功能启用/禁用

### 人性化

- 符合用户习惯的交互设计
- 清晰的状态反馈
- 最小化的学习成本

### 稳定性

- 多重保障机制
- 完善的异常处理
- 兼容性检查和适配

这个项目展现了如何为特定网站创建定制化的浏览器扩展，每个功能都针对具体的使用场景和用户需求，体现了深度的用户体验思考和技术实现能力。
